---
import Layout from '../../layouts/Layout.astro';

export async function getStaticPaths() {
  // Load shows data at build time
  const fs = await import('fs');
  const path = await import('path');
  const showsPath = path.join(process.cwd(), 'public/data/shows.json');
  const showsData = JSON.parse(fs.readFileSync(showsPath, 'utf-8'));

  return showsData.map((show: any) => ({
    params: { id: show.id },
    props: { show },
  }));
}

const { show } = Astro.props;
---

<Layout title={show.title}>
  <section class="container mx-auto px-4 py-16">
    <div class="max-w-4xl mx-auto">
      <!-- Back link -->
      <a href="/network" class="text-[#BF0404] hover:text-[#F20505] mb-8 inline-block">
        ← Back to Timeline
      </a>

      <!-- Show header -->
      <div class="mb-8">
        <div class="text-[#BF0404] font-bold mb-2">{show.date}</div>
        <h1 class="text-4xl font-bold text-white mb-4">{show.title}</h1>
        {show.genre && (
          <div class="inline-block px-3 py-1 bg-gray-800 rounded-full text-sm text-gray-300">
            {show.genre}
          </div>
        )}
      </div>

      <!-- Show details -->
      <div class="card space-y-6">
        <div>
          <h2 class="text-xl font-bold text-white mb-4">Artists</h2>
          <div class="space-y-2">
            {show.artists.map((artist: any) => (
              <div class="flex items-center gap-3">
                <a
                  href={`/artists/${artist.id}`}
                  class="text-[#F0F0F0] hover:text-[#BF0404] transition-colors text-lg"
                >
                  {artist.name}
                </a>
                {artist.isHeadliner && (
                  <span class="text-xs px-2 py-1 bg-[#BF0404]/20 text-[#F20505] rounded">
                    Headliner
                  </span>
                )}
              </div>
            ))}
          </div>
        </div>

        <div class="grid grid-cols-2 gap-4 pt-6 border-t border-gray-800">
          <div>
            <div class="text-gray-500 text-sm">Event Type</div>
            <div class="text-gray-300 capitalize">{show.eventType.replace('_', ' ')}</div>
          </div>
          {show.ticketPrice && (
            <div>
              <div class="text-gray-500 text-sm">Ticket Price</div>
              <div class="text-gray-300">{show.ticketPrice}</div>
            </div>
          )}
          {show.soldOut && (
            <div class="col-span-2">
              <div class="text-[#F20505] font-bold">SOLD OUT</div>
            </div>
          )}
        </div>
      </div>

      <!-- View in timeline -->
      <div class="mt-8">
        <a
          href={`/network#show-${show.id}`}
          class="inline-block bg-[#BF0404] hover:bg-[#F20505] text-white font-bold px-6 py-3 rounded-lg transition-colors"
        >
          View in Timeline →
        </a>
      </div>
    </div>
  </section>
</Layout>
